!function(e){function t(t){for(var r,s,a=t[0],l=t[1],c=t[2],u=0,h=[];u<a.length;u++)s=a[u],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&h.push(i[s][0]),i[s]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);for(p&&p(t);h.length;)h.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,a=1;a<n.length;a++){var l=n[a];0!==i[l]&&(r=!1)}r&&(o.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},i={0:0},o=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var a=window.webpackJsonp=window.webpackJsonp||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var p=l;o.push([6,1]),n()}([function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(13),t),i(n(4),t),i(n(14),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerRoles=t.PlayerEvent=void 0,function(e){e.SUPPORT_ATTACKER="SUPPORT_ATTACKER",e.RECEIVE_BALL="RECEIVE_BALL",e.PASS_TO_ME="PASS_TO_ME",e.GO_HOME="GO_HOME",e.WAIT="WAIT"}(t.PlayerEvent||(t.PlayerEvent={})),function(e){e[e.Goalkeeper=0]="Goalkeeper",e[e.Attacker=1]="Attacker",e[e.Defender=2]="Defender"}(t.PlayerRoles||(t.PlayerRoles={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11);Object.defineProperty(t,"Goal",{enumerable:!0,get:function(){return r.default}});var i=n(12);Object.defineProperty(t,"Ball",{enumerable:!0,get:function(){return i.default}});var o=n(15);Object.defineProperty(t,"Info",{enumerable:!0,get:function(){return o.default}});var s=n(16);Object.defineProperty(t,"Spot",{enumerable:!0,get:function(){return s.default}});var a=n(17);Object.defineProperty(t,"Score",{enumerable:!0,get:function(){return a.default}});var l=n(18);Object.defineProperty(t,"Pitch",{enumerable:!0,get:function(){return l.default}});var c=n(19);Object.defineProperty(t,"SupportSpots",{enumerable:!0,get:function(){return c.default}});var p=n(5);Object.defineProperty(t,"PlayerBase",{enumerable:!0,get:function(){return p.default}});var u=n(20);Object.defineProperty(t,"PlayerField",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"PlayerFieldStates",{enumerable:!0,get:function(){return u.PlayerFieldStates}});var h=n(21);Object.defineProperty(t,"PlayerKeeper",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"PlayerKeeperStates",{enumerable:!0,get:function(){return h.PlayerKeeperStates}});var f=n(22);Object.defineProperty(t,"Team",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"TeamStates",{enumerable:!0,get:function(){return f.TeamStates}})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.players=void 0;var r=n(1);t.players=[{id:1,name:"Player 1",role:r.PlayerRoles.Goalkeeper,speed:3.5},{id:2,name:"Player 2",role:r.PlayerRoles.Defender,speed:3.5},{id:3,name:"Player 3",role:r.PlayerRoles.Defender,speed:3.5},{id:4,name:"Player 4",role:r.PlayerRoles.Attacker,speed:3.5},{id:5,name:"Player 5",role:r.PlayerRoles.Attacker,speed:3.5}]},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),a=n(0),l=n(2),c=function(e){function t(t,n,r,i,s,c,p,u,h){var f=e.call(this,t,n,r,"sprites",i)||this,y=new l.Info(f,c,h.isLeft);return f._seekOn=!1,f._persuitOn=!1,f._interposeOn=!1,f._team=h,f._home=f._homeDefault=f._target=u,f.scene.add.existing(f),f.scene.physics.world.enable(f),f.scene.add.existing(y),f.setData(o(o({},s),{index:c})),f.setName(p),f.setSize(2*a.PLAYER_RADIUS,2*a.PLAYER_RADIUS),f.setCircle(a.PLAYER_RADIUS),f.setDepth(3),f}return i(t,e),t.prototype.preUpdate=function(e,t){var n=new Phaser.Math.Vector2,r=new Phaser.Math.Vector2(this.speedPerFrame*t,0);if(this.seekOn&&(this.trackTarget(),n.add(r.clone().rotate(Phaser.Math.Angle.BetweenPoints(this.position,this.target)))),this.persuitOn){var i=this.scene.ball.body.speed,o=this.scene.ball.position.clone().subtract(this.position).length(),s=0!==i?o/i:0,a=this.scene.ball.futurePosition(s);this.setTarget(a),this.trackTarget(),n.add(r.clone().rotate(Phaser.Math.Angle.BetweenPoints(this.position,this.target)))}if(this.interposeOn){this.trackBall(),this.setTarget(this.rearInterposeTarget);var l=this.position.distance(this.target),c=this.scene.ball.position.clone().subtract(this.target).normalize(),p=this.target.clone().add(new Phaser.Math.Vector2(c.x*l,c.y*l)),u=Phaser.Math.Angle.BetweenPoints(this.position,p);n.add(r.clone().rotate(u))}this.setVelocity(n.x,n.y)},t.prototype.findSupport=function(){var e=this.team.calculateSupportingPlayer();this.team.supportingPlayer?e&&e!==this.team.supportingPlayer&&(this.team.supportingPlayer?this.scene.events.emit(s.PlayerEvent.GO_HOME,e):(this.team.setSupportingPlayer(e),this.scene.events.emit(s.PlayerEvent.SUPPORT_ATTACKER,e))):(this.team.setSupportingPlayer(e),e&&this.scene.events.emit(s.PlayerEvent.SUPPORT_ATTACKER,e))},t.prototype.setTarget=function(e){return this._target=e,this},t.prototype.setHome=function(e){return this._home=e,this},t.prototype.setDefaultHomeRegion=function(){return this._home=this._homeDefault,this},t.prototype.setSeekOn=function(e){return this._seekOn=e,this},t.prototype.setPersuitOn=function(e){return this._persuitOn=e,this},t.prototype.setInterposeOn=function(e){return this._interposeOn=e,this},t.prototype.sendHomeIfWaiting=function(){return this},t.prototype.isCloseToHome=function(e){return void 0===e&&(e=10),this.position.fuzzyEquals(this.home,e)},t.prototype.isCloseToTarget=function(e){return void 0===e&&(e=10),this.position.fuzzyEquals(this.target,e)},t.prototype.isPositionInFrontOfPlayer=function(e){return e.clone().subtract(this.position).dot(this.facing)>0},t.prototype.trackTarget=function(){return this.rotateToTarget(this.target),this},t.prototype.trackBall=function(){return this.rotateToTarget(this.scene.ball.position),this},t.prototype.rotateToTarget=function(e){return this.setRotation(Phaser.Math.Angle.BetweenPoints(this.position,e)),this},Object.defineProperty(t.prototype,"index",{get:function(){return this.getData("index")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"role",{get:function(){return this.getData("role")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"speedPerFrame",{get:function(){return this.getData("speed")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAtHome",{get:function(){return this.isCloseToHome()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAtTarget",{get:function(){return this.isCloseToTarget()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"seekOn",{get:function(){return this._seekOn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"persuitOn",{get:function(){return this._persuitOn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"interposeOn",{get:function(){return this._interposeOn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this._target},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"home",{get:function(){return this._home},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"team",{get:function(){return this._team},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return new Phaser.Math.Vector2(this.x,this.y)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"facing",{get:function(){return new Phaser.Math.Vector2(1,0).setAngle(this.rotation)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"speedPerSecond",{get:function(){return this.speedPerFrame*a.DELTA*1e3},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isControllingPlayer",{get:function(){return this===this.team.controllingPlayer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isClosestPlayerToBall",{get:function(){return this===this.team.closestPlayer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isClosestPlayerOnPitchToBall",{get:function(){return this===this.team.closestPlayerOnPitchToBall},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isBallWithinReceivingRange",{get:function(){return this.position.distance(this.scene.ball.position)<a.RECEIVING_RANGE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isBallWithinKickingRange",{get:function(){return this.position.distance(this.scene.ball.position)<a.KICKING_RANGE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isBallWithinKeeperRange",{get:function(){return this.position.distance(this.scene.ball.position)<a.KEEPER_RANGE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isBallWithinRangeForIntercept",{get:function(){return this.team.goalHome.position.distance(this.scene.ball.position)<a.INTERCEPT_RANGE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isTooFarFromGoalMouth",{get:function(){return this.position.distance(this.rearInterposeTarget)>a.INTERCEPT_RANGE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isThreatened",{get:function(){for(var e=this.team.opponents.players,t=0;t<e.length;t++){var n=e[t];if(this.isPositionInFrontOfPlayer(n.position)&&this.position.distance(n.position)<a.PLAYER_COMFORT_DISTANCE)return!0}return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAheadOfAttacker",{get:function(){return Math.abs(this.x-this.team.goalOpponents.position.x)<Math.abs(this.team.controllingPlayer.x-this.team.goalOpponents.position.x)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInHotPosition",{get:function(){return Math.abs(this.y-this.team.goalOpponents.position.y)<this.scene.pitch.width/3},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rearInterposeTarget",{get:function(){var e=this.team.goalHome.position.x,t=this.team.goalHome.position.y-this.team.goalHome.height/2+this.team.goalHome.height*((this.scene.ball.position.y-this.scene.pitch.y)/this.scene.pitch.height);return new Phaser.Math.Vector2(e,t)},enumerable:!1,configurable:!0}),t}(Phaser.Physics.Arcade.Sprite);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(3);var r=n(7),i={type:Phaser.AUTO,width:1280,height:704,render:{pixelArt:!0,antialias:!1,antialiasGL:!1},parent:"phaser",physics:{default:"arcade",arcade:{debug:!1,gravity:{y:0}}},scene:[r.LoaderScene,r.PitchScene]};window.addEventListener("load",(function(){new Phaser.Game(i)}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8);Object.defineProperty(t,"LoaderScene",{enumerable:!0,get:function(){return r.default}});var i=n(9);Object.defineProperty(t,"PitchScene",{enumerable:!0,get:function(){return i.default}})},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.preload=function(){this.load.image("font3x5","./assets/images/font3x5.png"),this.load.image("goal","./assets/images/goal.png"),this.load.image("pitch","./assets/images/pitch.png"),this.load.spritesheet("sprites","./assets/images/sprites.png",{frameWidth:16,frameHeight:16})},t.prototype.create=function(){this.cache.bitmapFont.add("font3x5",Phaser.GameObjects.RetroFont.Parse(this,{image:"font3x5",width:4,height:6,chars:Phaser.GameObjects.RetroFont.TEXT_SET5,charsPerRow:16,lineSpacing:1,"spacing.x":0,"spacing.y":0,"offset.x":0,"offset.y":0})),this.game.events.on(Phaser.Core.Events.BLUR,(function(){this.scene.get("pitch").scene.pause()}),this).on(Phaser.Core.Events.FOCUS,(function(){this.scene.get("pitch").scene.resume()}),this),this.scene.start("pitch")},t}(Phaser.Scene);t.default=o},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(10),s=n(2),a=n(0),l=function(e){function t(){return e.call(this,{key:"pitch",active:!1,visible:!1})||this}return i(t,e),t.prototype.init=function(){this.data.set({goalkeeperHasBall:!1,gameOn:!1,ballInGoal:!1},!1)},t.prototype.create=function(){this._pitch=new s.Pitch(this),this._goalA=new s.Goal(this,this.pitch.x,this.pitch.midpoint.y,1),this._goalB=new s.Goal(this,this.pitch.x+this.pitch.width,this.pitch.midpoint.y,-1),this._ball=new s.Ball(this,this.pitch.midpoint.x,this.pitch.midpoint.y),this._teamA=new s.Team(this,a.teams[0],!0,this.goalB,this.goalA),this._teamB=new s.Team(this,a.teams[1],!1,this.goalA,this.goalB),this._score=new s.Score(this,this.game.renderer.width/2,8),this.teamA.setOpponents(this.teamB),this.teamB.setOpponents(this.teamA),this.physics.add.collider(this.teamA,this.teamB),this.physics.add.collider(this.teamB,this.teamA),this.physics.add.collider(this._ball,[this.goalA,this.goalB,this.pitch]),this.physics.add.collider([this.teamA,this.teamB],[this.goalA,this.goalB,this.pitch])},t.prototype.update=function(){this.data.get("ballInGoal")?this.goalA.isBallInGoal||this.goalB.isBallInGoal||this.data.set("ballInGoal",!1):this.goalA.isBallInGoal?(this.goalA.incrementScore(),this._score.setText(this.goalB.scored+"-"+this.goalA.scored),this.data.set("ballInGoal",!0)):this.goalB.isBallInGoal&&(this.goalB.incrementScore(),this._score.setText(this.goalB.scored+"-"+this.goalA.scored),this.data.set("ballInGoal",!0)),o.updateUi(this)},t.prototype.setGoalkeeperHasBall=function(e){this.data.set("goalkeeperHasBall",e)},t.prototype.setGameOn=function(e){this.data.set("gameOn",e)},Object.defineProperty(t.prototype,"goalkeeperHasBall",{get:function(){return this.data.get("goalkeeperHasBall")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gameOn",{get:function(){return this.data.get("gameOn")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pitch",{get:function(){return this._pitch},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ball",{get:function(){return this._ball},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"teamA",{get:function(){return this._teamA},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"teamB",{get:function(){return this._teamB},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"goalA",{get:function(){return this._goalA},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"goalB",{get:function(){return this._goalB},enumerable:!1,configurable:!0}),t}(Phaser.Scene);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateUi=t.setText=void 0;var r=n(1),i=n(2);t.setText=function(e,t){document.querySelector(e).innerHTML=t},t.updateUi=function(e){t.setText("#pitch-gameon",""+e.gameOn),t.setText("#pitch-goalkeeper",""+e.goalkeeperHasBall),t.setText("#red-score",""+e.goalA.scored),t.setText("#blue-score",""+e.goalB.scored),[e.teamA,e.teamB].forEach((function(e){t.setText("#"+e.name+"-state",function(e){switch(e.state){case i.TeamStates.Attacking:return"Attacking";case i.TeamStates.PrepareForKickOff:return"PrepareForKickOff";case i.TeamStates.Defending:return"Defending"}}(e)),t.setText("#"+e.name+"-closest",""+(e.closestPlayer?e.closestPlayer.index+1:"-")),t.setText("#"+e.name+"-controlling",""+(e.controllingPlayer?e.controllingPlayer.index+1:"-")),t.setText("#"+e.name+"-supporting",""+(e.supportingPlayer?e.supportingPlayer.index+1:"-")),t.setText("#"+e.name+"-receiving",""+(e.receivingPlayer?e.receivingPlayer.index+1:"-")),e.players.forEach((function(n,o){t.setText("#"+e.name+"-state-"+(o+1),function(e){if(e.role===r.PlayerRoles.Goalkeeper)switch(e.state){case i.PlayerKeeperStates.InterceptBall:return"InterceptBall";case i.PlayerKeeperStates.PutBallBackInPlay:return"PutBallBackInPlay";case i.PlayerKeeperStates.ReturnToHome:return"ReturnToHome";case i.PlayerKeeperStates.TendGoal:return"TendGoal"}switch(e.state){case i.PlayerFieldStates.ChaseBall:return"ChaseBall";case i.PlayerFieldStates.Dribble:return"Dribble";case i.PlayerFieldStates.KickBall:return"KickBall";case i.PlayerFieldStates.ReceiveBall:return"ReceiveBall";case i.PlayerFieldStates.ReturnToHome:return"ReturnToHome";case i.PlayerFieldStates.SupportAttacker:return"Support";case i.PlayerFieldStates.Wait:return"Wait"}}(n)),t.setText("#"+e.name+"-persuit-"+(o+1),""+n.persuitOn),t.setText("#"+e.name+"-seek-"+(o+1),""+n.seekOn),t.setText("#"+e.name+"-interpose-"+(o+1),""+n.interposeOn),t.setText("#"+e.name+"-home-"+(o+1),""+n.isAtHome),t.setText("#"+e.name+"-target-"+(o+1),""+n.isAtTarget)}))}))}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;o._scored=0,o.scene.add.existing(o),o._facing=new Phaser.Math.Vector2(i,0),o._image=o.scene.add.image(n-32*i,r,"goal").setFlipX(i<0).setDepth(8),o._bounds=new Phaser.Geom.Rectangle(n+(i>0?-64:16),r-56,48,112);var s=new Phaser.GameObjects.Rectangle(o.scene,n-60*i,r,8,128),a=new Phaser.GameObjects.Rectangle(o.scene,n-34*i,r-60,60,8),l=new Phaser.GameObjects.Rectangle(o.scene,n-34*i,r+60,60,8),c=new Phaser.GameObjects.Ellipse(o.scene,n-4*i,r+60,8,8),p=new Phaser.GameObjects.Ellipse(o.scene,n-4*i,r-60,8,8);return o.scene.physics.world.enable([s,a,l,p,c],Phaser.Physics.Arcade.STATIC_BODY),o.add(s),o.add(a),o.add(p),o.add(l),o.add(c),o}return i(t,e),t.prototype.incrementScore=function(){this._scored++},Object.defineProperty(t.prototype,"scored",{get:function(){return this._scored},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"facing",{get:function(){return this._facing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bounds",{get:function(){return this._bounds},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.bounds.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return new Phaser.Math.Vector2(this._image.x+32*this._facing.x,this._image.y)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isBallInGoal",{get:function(){return Phaser.Geom.Intersects.CircleToRectangle(this.scene.ball.bounds,this.bounds)},enumerable:!1,configurable:!0}),t}(Phaser.GameObjects.Group);t.default=o},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),s=function(e){function t(t,n,r){var i=e.call(this,t,n,r,"sprites",0)||this;return i.scene.add.existing(i),i.scene.physics.world.enable(i),i.setSize(2*o.BALL_RADIUS,2*o.BALL_RADIUS),i.setCircle(o.BALL_RADIUS),i.setBounce(o.BALL_BOUNCE,o.BALL_BOUNCE),i.setFrictionX(0),i.setDepth(3),i}return i(t,e),t.prototype.preUpdate=function(e,t){var n=this.body.velocity.clone().normalize(),r=t/1e3*o.BALL_DRAG,i=new Phaser.Math.Vector2(n.x*r,n.y*r),s=this.body.velocity.clone().add(i);(Math.abs(s.x)>Math.abs(this.body.velocity.x)||Phaser.Math.Fuzzy.Equal(s.x,0,.5))&&(s.x=0),(Math.abs(s.y)>Math.abs(this.body.velocity.y)||Phaser.Math.Fuzzy.Equal(s.y,0,.5))&&(s.y=0),this.setVelocity(s.x,s.y)},t.prototype.addNoiseToKick=function(e,t){var n=.01*Math.PI*(2*Math.random()-1);return t.clone().subtract(e).rotate(n).add(e)},t.prototype.kick=function(e,t){var n=e.clone().normalize();return this.setVelocity(n.x*t,n.y*t),this},t.prototype.place=function(e,t){return this.setVelocity(0,0),this.setAngularVelocity(0),this.setPosition(e,t),this},t.prototype.trap=function(){return this.setVelocity(0,0),this.setAngularVelocity(0),this},t.prototype.timeToCoverDistance=function(e,t){var n=t*t+2*e*o.BALL_DRAG;return n<=0?-1:(Math.sqrt(n)-t)/o.BALL_DRAG},t.prototype.futurePosition=function(e){var t=this.body.velocity.clone().normalize(),n=.5*o.BALL_DRAG*e*e,r=new Phaser.Math.Vector2(t.x*n,t.y*n),i=new Phaser.Math.Vector2(this.body.velocity.x*e,this.body.velocity.y*e);return this.position.add(i).add(r)},Object.defineProperty(t.prototype,"position",{get:function(){return new Phaser.Math.Vector2(this.x,this.y)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bounds",{get:function(){return new Phaser.Geom.Circle(this.x,this.y,o.BALL_RADIUS)},enumerable:!1,configurable:!0}),t}(Phaser.Physics.Arcade.Image);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.teams=void 0;var r=n(4),i=function(e){return new Phaser.Math.Vector2(160+e%6*192,160+192*Math.floor(e/6))};t.teams=[{id:1,frame:1,name:"red",players:r.players,regions:{defending:[i(6),i(1),i(13),i(2),i(14)],attacking:[i(6),i(2),i(14),i(10),i(9)]}},{id:2,frame:2,name:"blue",players:r.players,regions:{defending:[i(11),i(16),i(4),i(15),i(3)],attacking:[i(11),i(14),i(3),i(7),i(8)]}}]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SUPPORT_SPOT_OPTIMAL_PASS_DISTANCE=t.SUPPORT_SPOT_CONTROLLLING_DISTANCE_STRENGTH=t.SUPPORT_SPOT_CAN_SHOOT_STRENGTH=t.SUPPORT_SPOT_PASS_SAFE_STRENGTH=t.SUPPORT_SPOT_UPDATE_FREQUENCY=t.SHOOT_ATTEMPTS=t.BOUNDS_BORDER=t.PLAYER_RADIUS=t.BALL_RADIUS=t.BALL_BOUNCE=t.BALL_DRAG=t.KEEPER_RANGE=t.KICKING_RANGE=t.INTERCEPT_RANGE=t.DRIBBLE_POWER_GOAL=t.DRIBBLE_POWER=t.PLAYER_COMFORT_DISTANCE=t.RECEIVING_RANGE=t.MIN_PASS_DISTANCE=t.PASS_THREAT_RADIUS=t.POT_SHOT_CHANCE=t.MAX_PASS_POWER=t.MAX_SHOT_POWER=t.DELTA=t.FPS=void 0,t.FPS=60,t.DELTA=1/t.FPS,t.MAX_SHOT_POWER=560,t.MAX_PASS_POWER=480,t.POT_SHOT_CHANCE=.005,t.PASS_THREAT_RADIUS=64,t.MIN_PASS_DISTANCE=128,t.RECEIVING_RANGE=64,t.PLAYER_COMFORT_DISTANCE=96,t.DRIBBLE_POWER=96,t.DRIBBLE_POWER_GOAL=128,t.INTERCEPT_RANGE=192,t.KICKING_RANGE=20,t.KEEPER_RANGE=20,t.BALL_DRAG=-256,t.BALL_BOUNCE=.5,t.BALL_RADIUS=8,t.PLAYER_RADIUS=8,t.BOUNDS_BORDER=64,t.SHOOT_ATTEMPTS=5,t.SUPPORT_SPOT_UPDATE_FREQUENCY=2e3,t.SUPPORT_SPOT_PASS_SAFE_STRENGTH=2,t.SUPPORT_SPOT_CAN_SHOOT_STRENGTH=1,t.SUPPORT_SPOT_CONTROLLLING_DISTANCE_STRENGTH=2,t.SUPPORT_SPOT_OPTIMAL_PASS_DISTANCE=256},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n,r){var i=e.call(this,t.scene,0,0)||this;return i.scene.add.existing(i),i.setDepth(5),i.add(new Phaser.GameObjects.Line(i.scene,12,4,0,0,16,-16,r?16711680:255)),i.add(new Phaser.GameObjects.Rectangle(i.scene,12,-26,10,14,r?16711680:255).setOrigin(0,0)),i.add(new Phaser.GameObjects.BitmapText(i.scene,14,-24,"font3x5",(n+1).toString(),null).setOrigin(0,0).setScale(2)),i.scene.events.on("postupdate",(function(){this.x=t.x,this.y=t.y}),i),i}return i(t,e),t}(Phaser.GameObjects.Container);t.default=o},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"score",{get:function(){return this._score},set:function(e){this._score=e},enumerable:!1,configurable:!0}),t}(Phaser.Math.Vector2);t.default=o},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n,r){var i=e.call(this,t,n,r,"font3x5","0-0",null,Phaser.GameObjects.BitmapText.ALIGN_CENTER)||this;return i.scene.add.existing(i),i.setOrigin(.5,0),i.setScale(8),i.setDepth(10),i}return i(t,e),t}(Phaser.GameObjects.BitmapText);t.default=o},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),s=function(e){function t(t){var n=e.call(this,t)||this;n.scene.add.existing(n),n._image=n.scene.add.image(0,0,"pitch").setOrigin(0,0),n._bounds=new Phaser.Geom.Rectangle(o.BOUNDS_BORDER,o.BOUNDS_BORDER,n._image.width-2*o.BOUNDS_BORDER,n._image.height-2*o.BOUNDS_BORDER);var r=new Phaser.GameObjects.Rectangle(n.scene,0,0,n._image.width,o.BOUNDS_BORDER).setOrigin(0,0),i=new Phaser.GameObjects.Rectangle(n.scene,0,n._image.height-o.BOUNDS_BORDER,n._image.width,o.BOUNDS_BORDER).setOrigin(0,0),s=new Phaser.GameObjects.Rectangle(n.scene,0,0,o.BOUNDS_BORDER,(n._image.height-120)/2).setOrigin(0,0),a=new Phaser.GameObjects.Rectangle(n.scene,0,n._image.height,o.BOUNDS_BORDER,(n._image.height-120)/2).setOrigin(0,1),l=new Phaser.GameObjects.Rectangle(n.scene,n._image.width,0,o.BOUNDS_BORDER,(n._image.height-120)/2).setOrigin(1,0),c=new Phaser.GameObjects.Rectangle(n.scene,n._image.width,n._image.height,o.BOUNDS_BORDER,(n._image.height-120)/2).setOrigin(1,1);return n.add(r),n.add(i),n.add(l),n.add(c),n.add(s),n.add(a),n.scene.physics.world.enable([r,i,s,a,l,c],Phaser.Physics.Arcade.STATIC_BODY),n}return i(t,e),Object.defineProperty(t.prototype,"bounds",{get:function(){return this._bounds},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.bounds.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.bounds.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this.bounds.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.bounds.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"midpoint",{get:function(){return new Phaser.Math.Vector2(this.x+this.width/2,this.y+this.height/2)},enumerable:!1,configurable:!0}),t}(Phaser.GameObjects.Group);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(2),o=function(){function e(e,t,n){this._supportSpot=null;var o=n?928:352;this._team=t,this._spots=[],this._circles=[];for(var s=0;s<6;s++)for(var a=0;a<5;a++){var l=new Phaser.Math.Vector2(o-160+80*a,152+80*s);this._spots.push(new i.Spot(l.x,l.y)),this._circles.push(e.add.circle(l.x,l.y,8,65280).setDepth(1).setVisible(!1))}e.time.addEvent({delay:r.SUPPORT_SPOT_UPDATE_FREQUENCY,loop:!0,callbackScope:this,callback:function(){var e=this;this._team.isInControl&&this.calculateSupportSpot(),this._circles.forEach((function(t){t.setVisible(e._team.isInControl)}))}})}return e.prototype.calculateSupportSpot=function(){var e=this,t=0,n=0;return this._supportSpot=null,this._spots.forEach((function(i,o){if(i.score=1,e._team.isPassSafeFromAllOpponents(e._team.controllingPlayer.position,i,null,r.MAX_PASS_POWER)&&(i.score+=r.SUPPORT_SPOT_PASS_SAFE_STRENGTH),e._team.canShoot(i,r.MAX_SHOT_POWER)[0]&&(i.score+=r.SUPPORT_SPOT_CAN_SHOOT_STRENGTH),e._team.isInControl){var s=e._team.controllingPlayer.position.distance(i),a=Math.abs(r.SUPPORT_SPOT_OPTIMAL_PASS_DISTANCE-s);if(a<r.SUPPORT_SPOT_OPTIMAL_PASS_DISTANCE){var l=r.SUPPORT_SPOT_CONTROLLLING_DISTANCE_STRENGTH*(r.SUPPORT_SPOT_OPTIMAL_PASS_DISTANCE-a)/r.SUPPORT_SPOT_OPTIMAL_PASS_DISTANCE;i.score+=l}}e._circles[o].setAlpha(.25).setScale(i.score/4),i.score>t&&(t=i.score,n=o)})),this._supportSpot=this._spots[n],this._circles[n].setAlpha(1),this._supportSpot},Object.defineProperty(e.prototype,"supportSpot",{get:function(){return this._supportSpot||this.calculateSupportSpot()},enumerable:!1,configurable:!0}),e}();t.default=o},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerFieldStates=void 0;var o,s=n(1),a=n(0),l=n(5);!function(e){e[e.Wait=0]="Wait",e[e.ReceiveBall=1]="ReceiveBall",e[e.KickBall=2]="KickBall",e[e.Dribble=3]="Dribble",e[e.ChaseBall=4]="ChaseBall",e[e.ReturnToHome=5]="ReturnToHome",e[e.SupportAttacker=6]="SupportAttacker"}(o=t.PlayerFieldStates||(t.PlayerFieldStates={}));var c=function(e){function t(t,n,r,i,l,c,p,u,h){var f=e.call(this,t,n,r,i,l,c,p,u,h)||this;return f.scene.events.on(s.PlayerEvent.RECEIVE_BALL,(function(e,t){e===this&&(this.setTarget(t),this.setState(o.ReceiveBall))}),f).on(s.PlayerEvent.SUPPORT_ATTACKER,(function(e){e===this&&this.state!==o.SupportAttacker&&this.setState(o.SupportAttacker)}),f).on(s.PlayerEvent.GO_HOME,(function(e){e===this&&this.setState(o.ReturnToHome)}),f).on(s.PlayerEvent.WAIT,(function(e){e===this&&this.setState(o.Wait)}),f).on(s.PlayerEvent.PASS_TO_ME,(function(e,t){e===this&&this.isBallWithinKickingRange&&(this.team.ball.kick(t.position.clone().subtract(this.scene.ball.position).normalize(),a.MAX_PASS_POWER),this.scene.events.emit(s.PlayerEvent.RECEIVE_BALL,t,t.position),this.setState(o.Wait),this.findSupport())}),f),f.setState(o.ReturnToHome),f}return i(t,e),t.prototype.setState=function(t){switch(this.state){case o.ChaseBall:this.setSeekOn(!1);break;case o.SupportAttacker:this.team.setSupportingPlayer(null),this.setSeekOn(!1);break;case o.ReturnToHome:this.setSeekOn(!1);break;case o.ReceiveBall:this.setSeekOn(!1),this.setPersuitOn(!1),this.team.setReceivingPlayer(null)}switch(e.prototype.setState.call(this,t),t){case o.ChaseBall:this.setSeekOn(!0),this.setTarget(this.scene.ball.position);break;case o.SupportAttacker:this.setSeekOn(!0),this.setTarget(this.team.getSupportSpot());break;case o.ReturnToHome:this.setSeekOn(!0),this.setTarget(this.home);break;case o.Wait:this.scene.gameOn||this.setTarget(this.home);break;case o.Dribble:case o.KickBall:this.team.setControllingPlayer(this);break;case o.ReceiveBall:this.team.setReceivingPlayer(this),this.team.setControllingPlayer(this),this.isInHotPosition||Math.random()<.5&&!this.team.isOpponentWithinRadius(this.position,a.PASS_THREAT_RADIUS)?(this.setPersuitOn(!1),this.setSeekOn(!0)):(this.setSeekOn(!1),this.setPersuitOn(!0))}return this},t.prototype.preUpdate=function(t,n){switch(this.state){case o.ChaseBall:this.isBallWithinKickingRange?this.setState(o.KickBall):this.isClosestPlayerToBall?this.setTarget(this.scene.ball.position):this.setState(o.ReturnToHome);break;case o.SupportAttacker:if(this.team.isInControl){var r=this.team.getSupportSpot();r!==this.target&&(this.setTarget(r),this.setSeekOn(!0)),(p=this.team.canShoot(this.position,a.MAX_SHOT_POWER)[0])&&this.team.requestPass(this),this.isAtTarget&&(this.setSeekOn(!1),this.trackBall(),this.setVelocity(0,0),this.isThreatened||this.team.requestPass(this))}else this.setState(o.ReturnToHome);break;case o.ReturnToHome:this.scene.gameOn?this.isClosestPlayerToBall&&null===this.team.receivingPlayer&&!this.scene.goalkeeperHasBall?this.setState(o.ChaseBall):this.isCloseToHome(64)&&(this.setTarget(this.position),this.setState(o.Wait)):this.isAtTarget&&this.setState(o.Wait);break;case o.Wait:this.isAtTarget?(this.setSeekOn(!1),this.setVelocity(0,0),this.trackBall()):this.setSeekOn(!0),this.team.isInControl&&!this.isControllingPlayer&&this.isAheadOfAttacker?this.team.requestPass(this):this.scene.gameOn&&this.isClosestPlayerToBall&&!this.team.receivingPlayer&&!this.scene.goalkeeperHasBall&&this.setState(o.ChaseBall);break;case o.KickBall:var i=this.facing.clone().dot(this.scene.ball.position.clone().subtract(this.position).normalize());if(this.team.receivingPlayer||this.scene.goalkeeperHasBall||i<0)this.trackBall(),this.setState(o.ChaseBall);else{var l=a.MAX_SHOT_POWER*i,c=this.team.canShoot(this.scene.ball.position,l),p=c[0],u=c[1];if(p||Math.random()<a.POT_SHOT_CHANCE){var h=this.scene.ball.addNoiseToKick(this.scene.ball.position,u||this.team.goalOpponents.position);this.trackBall(),this.scene.ball.kick(h.clone().subtract(this.scene.ball.position),l),this.setState(o.Wait),this.findSupport()}else{var f=a.MAX_PASS_POWER*i,y=this.team.findPass(this,f,a.MIN_PASS_DISTANCE),P=y[0],d=y[1],g=y[2];if(this.isThreatened&&P){h=this.scene.ball.addNoiseToKick(this.scene.ball.position,g);this.trackBall(),this.scene.ball.kick(h.clone().subtract(this.scene.ball.position),f),this.setState(o.Wait),this.scene.events.emit(s.PlayerEvent.RECEIVE_BALL,d,g),this.findSupport()}else this.trackBall(),this.findSupport(),this.setState(o.Dribble)}}break;case o.Dribble:var _=this.team.goalOpponents.facing;if(this.team.goalOpponents.facing.clone().dot(this.facing)>0){var b=new Phaser.Math.Vector2(1,0),O=Math.sign(this.facing.y*_.x-this.facing.x*_.y),m=this.rotation+O*(Math.PI/5);this.scene.ball.kick(b.rotate(m),a.DRIBBLE_POWER)}else this.scene.ball.kick(this.team.goalHome.facing,a.DRIBBLE_POWER_GOAL);this.trackBall(),this.setState(o.ChaseBall);break;case o.ReceiveBall:this.isBallWithinReceivingRange||!this.team.isInControl?this.setState(o.ChaseBall):(this.persuitOn&&this.setTarget(this.scene.ball.position),this.isAtTarget&&(this.setSeekOn(!1),this.setPersuitOn(!1),this.trackBall(),this.setVelocity(0,0)))}e.prototype.preUpdate.call(this,t,n)},t.prototype.sendHomeIfWaiting=function(){return this.state!==o.Wait&&this.state!==o.ReturnToHome||(this.setTarget(this.home),this.setState(o.ReturnToHome)),this},t}(l.default);t.default=c},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerKeeperStates=void 0;var o,s=n(1),a=n(0),l=n(2);!function(e){e[e.TendGoal=0]="TendGoal",e[e.ReturnToHome=1]="ReturnToHome",e[e.PutBallBackInPlay=2]="PutBallBackInPlay",e[e.InterceptBall=3]="InterceptBall"}(o=t.PlayerKeeperStates||(t.PlayerKeeperStates={}));var c=function(e){function t(t,n,r,i,a,l,c,p,u){var h=e.call(this,t,n,r,i,a,l,c,p,u)||this;return h.scene.events.on(s.PlayerEvent.RECEIVE_BALL,(function(e){e===this&&this.setState(o.InterceptBall)}),h).on(s.PlayerEvent.GO_HOME,(function(e){e===this&&this.setState(o.ReturnToHome)}),h),h.setState(o.ReturnToHome),h}return i(t,e),t.prototype.setState=function(t){switch(this.state){case o.TendGoal:this.setInterposeOn(!1);break;case o.ReturnToHome:this.setSeekOn(!1);break;case o.InterceptBall:this.setPersuitOn(!1)}switch(e.prototype.setState.call(this,t),t){case o.TendGoal:this.setInterposeOn(!0),this.setTarget(this.rearInterposeTarget);break;case o.ReturnToHome:this.setTarget(this.home),this.setSeekOn(!0);break;case o.InterceptBall:this.setPersuitOn(!0);break;case o.PutBallBackInPlay:this.team.setControllingPlayer(this),this.team.sendFieldPlayersToHome(),this.team.opponents.sendFieldPlayersToHome()}return this},t.prototype.preUpdate=function(t,n){switch(e.prototype.preUpdate.call(this,t,n),this.state){case o.TendGoal:this.setTarget(this.rearInterposeTarget),this.isBallWithinKeeperRange?(this.scene.ball.trap(),this.scene.setGoalkeeperHasBall(!0),this.setState(o.PutBallBackInPlay)):this.isBallWithinRangeForIntercept&&!this.team.isInControl?this.setState(o.InterceptBall):this.isTooFarFromGoalMouth&&this.team.isInControl&&this.setState(o.ReturnToHome);break;case o.ReturnToHome:(this.isAtHome||this.team.opponents.isInControl)&&this.setState(o.TendGoal);break;case o.InterceptBall:this.isTooFarFromGoalMouth&&!this.isClosestPlayerOnPitchToBall?this.setState(o.ReturnToHome):this.isBallWithinKeeperRange&&(this.scene.ball.trap(),this.scene.setGoalkeeperHasBall(!0),this.setState(o.PutBallBackInPlay));break;case o.PutBallBackInPlay:var r=this.team.findPass(this,a.MAX_PASS_POWER,a.MIN_PASS_DISTANCE),i=r[0],l=r[1],c=r[2];i?(this.scene.ball.kick(c.clone().subtract(this.scene.ball.position),a.MAX_PASS_POWER),this.scene.setGoalkeeperHasBall(!1),this.scene.events.emit(s.PlayerEvent.RECEIVE_BALL,l,c),this.setState(o.TendGoal)):this.setVelocity(0,0)}},Object.defineProperty(t.prototype,"isAtHome",{get:function(){return this.isCloseToHome(128)},enumerable:!1,configurable:!0}),t}(l.PlayerBase);t.default=c},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.TeamStates=void 0;var o,s=n(1),a=n(0),l=n(2);!function(e){e[e.PrepareForKickOff=0]="PrepareForKickOff",e[e.Defending=1]="Defending",e[e.Attacking=2]="Attacking"}(o=t.TeamStates||(t.TeamStates={}));var c=function(e){function t(t,n,r,i,a){var c=e.call(this,t)||this;return c._supportingPlayer=null,c._controllingPlayer=null,c._receivingPlayer=null,c._closestPlayer=null,c.scene.add.existing(c),c._goalOpponents=i,c._goalHome=a,c._isLeft=r,c._regions=n.regions,c._spots=new l.SupportSpots(c.scene,c,r),c._players=n.players.map((function(e,t){var r=e.role===s.PlayerRoles.Goalkeeper?l.PlayerKeeper:l.PlayerField,i=c._regions.defending[t];return new r(c.scene,i.x+(128*Math.random()-64),i.y+(128*Math.random()-64),n.frame,e,t,n.name,i,c)})),c._players.forEach((function(e){c.add(e)})),c.setName(n.name),c.setState(o.PrepareForKickOff),c}return i(t,e),t.prototype.setState=function(e){switch(this.state){case o.PrepareForKickOff:this.scene.setGameOn(!0);break;case o.Attacking:this.setSupportingPlayer(null)}switch(this.state=e,e){case o.PrepareForKickOff:this.setControllingPlayer(null),this.setClosestPlayer(null),this.setSupportingPlayer(null),this.setReceivingPlayer(null),this.sendFieldPlayersToHome();break;case o.Defending:this.updateHomeTargets(this._regions.defending),this.updateTargetsOfWaitingPlayers();break;case o.Attacking:this.updateHomeTargets(this._regions.attacking),this.updateTargetsOfWaitingPlayers()}return this},t.prototype.preUpdate=function(){switch(this.setClosestPlayer(this.findClosestPlayer()),this.state){case o.PrepareForKickOff:this.allPlayersAtHome&&this.opponents.allPlayersAtHome&&this.setState(o.Defending);break;case o.Defending:this.isInControl&&this.setState(o.Attacking);break;case o.Attacking:this.isInControl||this.setState(o.Defending)}},t.prototype.kickOff=function(){this.setState(o.PrepareForKickOff)},t.prototype.sendFieldPlayersToHome=function(){var e=this;this.players.filter((function(e){return e.role!==s.PlayerRoles.Goalkeeper})).forEach((function(t){e.scene.events.emit(s.PlayerEvent.GO_HOME,t)}))},t.prototype.updateHomeTargets=function(e){this.players.forEach((function(t,n){t.setHome(e[n])}))},t.prototype.updateTargetsOfWaitingPlayers=function(){this.players.filter((function(e){return e.role!==s.PlayerRoles.Goalkeeper})).forEach((function(e){e.sendHomeIfWaiting()}))},t.prototype.canShoot=function(e,t,n){void 0===n&&(n=a.SHOOT_ATTEMPTS);for(var r=this.goalOpponents.position.clone(),i=this.goalOpponents.bounds.height-this.ball.height;n--;)if(r.y=this.goalOpponents.position.y-.5*i+Math.random()*i,this.ball.timeToCoverDistance(e.distance(r),t)>=0&&this.isPassSafeFromAllOpponents(e,r,null,t))return[!0,r];return[!1,null]},t.prototype.getBestPassToReceiver=function(e,t){var n=this,r=this.ball.position.distance(e.position),i=this.ball.timeToCoverDistance(r,t);if(i<=0)return[!1,null];var o=Math.sin(e.speedPerSecond*i/r),s=new Phaser.Math.Vector2(r,0).rotate(Phaser.Math.Angle.BetweenPoints(this.ball.position,e.position)),a=s.clone().add(this.ball.position),l=s.clone().rotate(-o).add(this.ball.position),c=s.clone().rotate(o).add(this.ball.position),p=1e4,u=null;return[l,a,c].forEach((function(r){var i=Math.abs(r.x-n.goalOpponents.position.x);i<p&&n.scene.pitch.bounds.contains(r.x,r.y)&&n.isPassSafeFromAllOpponents(n.ball.position,r,e,t)&&(p=i,u=r)})),u?[!0,u]:[!1,null]},t.prototype.findPass=function(e,t,n){var r=this,i=1e3,o=null,s=null;return this.players.filter((function(t){return t!==e})).forEach((function(a){if(e.position.distance(a.position)>n){var l=r.getBestPassToReceiver(a,t),c=l[0],p=l[1];if(c){var u=Math.abs(p.x-r.goalOpponents.position.x);u<i&&(i=u,s=a,o=p)}}})),s?[!0,s,o]:[!1,null,null]},t.prototype.requestPass=function(e){Math.random()<.1&&this.isPassSafeFromAllOpponents(this.controllingPlayer.position,e.position,e,a.MAX_PASS_POWER)&&this.scene.events.emit(s.PlayerEvent.PASS_TO_ME,this.controllingPlayer,e)},t.prototype.calculateSupportingPlayer=function(){var e=this,t=1e5,n=null;return this.players.filter((function(e){return e.role===s.PlayerRoles.Attacker&&!e.isControllingPlayer})).forEach((function(r){var i=r.position.distance(e._spots.supportSpot);i<t&&(t=i,n=r)})),n},t.prototype.isOpponentWithinRadius=function(e,t){return this.opponents.players.some((function(n){return n.position.distance(e)<t}))},t.prototype.isPassSafeFromAllOpponents=function(e,t,n,r){var i=this;return this.opponents.players.every((function(o){return i.isPassSafeFromOpponent(e,t,n,o,r)}))},t.prototype.isPassSafeFromOpponent=function(e,t,n,r,i){var o=Phaser.Math.Angle.BetweenPoints(e,t),s=Phaser.Math.Angle.BetweenPoints(e,r.position),a=e.distance(r.position),l=new Phaser.Math.Vector2(a*Math.cos(s-o),a*Math.sin(s-o));return l.x<0||(e.distance(t)<a?!n||r.position.distance(t)>n.position.distance(t):!(Math.abs(l.y)<r.speedPerSecond*this.ball.timeToCoverDistance(l.x,i)))},t.prototype.findClosestPlayer=function(){var e=this,t=this.players[0];return this.players.forEach((function(n){n.position.distance(e.ball.position)<t.position.distance(e.ball.position)&&(t=n)})),t},t.prototype.setClosestPlayer=function(e){this._closestPlayer=e},t.prototype.setControllingPlayer=function(e){this._controllingPlayer=e,this.opponents&&(this.opponents.controllingPlayer=null)},t.prototype.setReceivingPlayer=function(e){this._receivingPlayer=e},t.prototype.setSupportingPlayer=function(e){this._supportingPlayer=e},t.prototype.setOpponents=function(e){this._opponents=e},t.prototype.getSupportSpot=function(){return this._spots.supportSpot},Object.defineProperty(t.prototype,"receivingPlayer",{get:function(){return this._receivingPlayer},set:function(e){this._receivingPlayer=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"controllingPlayer",{get:function(){return this._controllingPlayer},set:function(e){this._controllingPlayer=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportingPlayer",{get:function(){return this._supportingPlayer},set:function(e){this._supportingPlayer=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInControl",{get:function(){return!!this.controllingPlayer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allPlayersAtHome",{get:function(){return this.players.every((function(e){return e.isAtHome}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ball",{get:function(){return this.scene.ball},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"players",{get:function(){return this._players},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"opponents",{get:function(){return this._opponents},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLeft",{get:function(){return this._isLeft},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"goalOpponents",{get:function(){return this._goalOpponents},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"goalHome",{get:function(){return this._goalHome},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"closestPlayer",{get:function(){return this._closestPlayer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"closestPlayerOnPitchToBall",{get:function(){return this.closestPlayer.position.distance(this.ball.position)<this.opponents.closestPlayer.position.distance(this.ball.position)?this.closestPlayer:this.opponents.closestPlayer},enumerable:!1,configurable:!0}),t}(Phaser.GameObjects.Group);t.default=c}]);